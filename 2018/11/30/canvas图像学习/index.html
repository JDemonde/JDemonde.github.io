<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>canvas图像学习 | JDemon&#39;s Blog</title>
  <meta name="author" content="JDemon">

  
  <meta name="description" content="1.canvas引用图片的方式 context.drawImage(image,dx,dy) 
image:可是是图片对象，也可是一个canvas
dx:对应canvas的x坐标
dy:对应canvas的y坐标
(若图片的大小超出了canvas，canvas将自动隐藏图片超出位置)
context.">
  
  

  <link rel="alternate" href="/atom.xml" title="JDemon&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head></html>

<body>
  <header id="header" class="inner"><nav>
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
</nav></header>
  <div id="content" class="inner"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <header>
    
  
    <h1 class="title">canvas图像学习</h1>
  

    <time datetime="2018-11-30T09:15:49.000Z">
  <span class="day">30</span><span class="month">Nov</span>
</time>
  </header>
  <div class="entry-content">
    
      <h3 id="1-canvas引用图片的方式"><a href="#1-canvas引用图片的方式" class="headerlink" title="1.canvas引用图片的方式"></a>1.canvas引用图片的方式</h3><p> context.drawImage(image,dx,dy) </p>
<pre><code>image:可是是图片对象，也可是一个canvas
dx:对应canvas的x坐标
dy:对应canvas的y坐标
(若图片的大小超出了canvas，canvas将自动隐藏图片超出位置)
</code></pre><p>context.drawImage(image,dx,dy,dw,dh)</p>
<pre><code>dx:对应canvas的x坐标
dy:对应canvas的y坐标
dw:应用于canvas的宽度
dh:应用于canvas的高度
</code></pre><p>context.drawImage(image,sx,sy,sw,sh,dx,dy,dw,dh)</p>
<pre><code>sx:图片的x坐标
sy:图片的y坐标
sw:图片的宽度
sh:图片的高度
dx:对应canvas的x坐标
dy:对应canvas的y坐标
dw:应用于canvas的宽度
dh:应用于canvas的高度 
</code></pre><hr>
<h3 id="2-离屏canvas（将第二个canvas的内容加载到第一个canvas上）"><a href="#2-离屏canvas（将第二个canvas的内容加载到第一个canvas上）" class="headerlink" title="2.离屏canvas（将第二个canvas的内容加载到第一个canvas上）"></a>2.离屏canvas（将第二个canvas的内容加载到第一个canvas上）</h3><p>例子:图片放大镜</p>
<p>效果图：</p>
<p><img src="/img/2.png" alt="" title="图片放大"></p>
<p>代码如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">		&lt;title&gt;&lt;/title&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;body  style=&quot;background: black;&quot;&gt;</span><br><span class="line">		&lt;canvas id=&quot;canvas&quot; style=&quot;display: block;margin: 0 auto;border: 1px solid #aaa;&quot;&gt;</span><br><span class="line">			您的浏览器不支持canvas</span><br><span class="line">		&lt;/canvas&gt;</span><br><span class="line">		&lt;canvas id=&quot;offCanvas&quot; style=&quot;display: none;&quot;&gt;</span><br><span class="line">			您的浏览器不支持canvas</span><br><span class="line">		&lt;/canvas&gt;</span><br><span class="line">		&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">			var canvas = document.getElementById(&apos;canvas&apos;);</span><br><span class="line">			var context = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">			</span><br><span class="line">			var offCanvas = document.getElementById(&apos;offCanvas&apos;);</span><br><span class="line">			var offContext = offCanvas.getContext(&apos;2d&apos;);</span><br><span class="line">			</span><br><span class="line">			var scale;</span><br><span class="line">			</span><br><span class="line">			var image = new Image();</span><br><span class="line">			var isMouseDown = false;</span><br><span class="line">			</span><br><span class="line">			window.onload = function()&#123;</span><br><span class="line">				canvas.width = 1152;</span><br><span class="line">				canvas.height = 768;</span><br><span class="line">				</span><br><span class="line">				</span><br><span class="line">				image.src = &apos;img5.jpg&apos;;</span><br><span class="line">				image.onload = function()&#123;</span><br><span class="line">					offCanvas.width = image.width;</span><br><span class="line">					offCanvas.height = image.height;</span><br><span class="line">					</span><br><span class="line">					scale = offCanvas.width/canvas.width;</span><br><span class="line">					context.drawImage(image,0,0,canvas.width,canvas.height);</span><br><span class="line">					offContext.drawImage(image,0,0);</span><br><span class="line">				&#125;	</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			//鼠标点击的点转化为相对于canvas的点</span><br><span class="line">			function windwoToCanvas(x,y)&#123;</span><br><span class="line">				var bbox = canvas.getBoundingClientRect();</span><br><span class="line">				return &#123;x:x-bbox.left,y:y-bbox.top&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			//鼠标点击</span><br><span class="line">			canvas.onmousedown = function(e)&#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				var point = windwoToCanvas(e.clientX,e.clientY);</span><br><span class="line">				isMouseDown = true;</span><br><span class="line">				</span><br><span class="line">				drawCanvasWithMagnifier(true,point);</span><br><span class="line">			&#125;</span><br><span class="line">			//鼠标移动</span><br><span class="line">			canvas.onmousemove = function(e)&#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				if(isMouseDown)&#123;</span><br><span class="line">					var point = windwoToCanvas(e.clientX,e.clientY);</span><br><span class="line">					drawCanvasWithMagnifier(true,point);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			canvas.onmouseup = function(e)&#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				isMouseDown = false;</span><br><span class="line">				drawCanvasWithMagnifier(false);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			canvas.onmouseout = function(e)&#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				isMouseDown = false;</span><br><span class="line">				drawCanvasWithMagnifier(false);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			//判断是否画</span><br><span class="line">			function drawCanvasWithMagnifier(isShowMagnifier,point)&#123;</span><br><span class="line">				context.clearRect(0,0,canvas.width,canvas.height);</span><br><span class="line">				context.drawImage(image,0,0,canvas.width,canvas.height);</span><br><span class="line">				if(isShowMagnifier)&#123;</span><br><span class="line">					drawMagnifier(point);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			//放大镜canvas</span><br><span class="line">			function drawMagnifier(point)&#123;</span><br><span class="line">				var imageLG_x = point.x * scale;</span><br><span class="line">				var imageLG_y = point.y * scale;</span><br><span class="line">				var mr = 200;</span><br><span class="line">				var sx = imageLG_x - mr;</span><br><span class="line">				var sy = imageLG_y - mr;</span><br><span class="line">				</span><br><span class="line">				var dx = point.x - mr;</span><br><span class="line">				var dy = point.y - mr;</span><br><span class="line">				</span><br><span class="line">				context.save();</span><br><span class="line">				context.lineWidth  = 10;</span><br><span class="line">				context.strokeStyle = &apos;#069&apos;;</span><br><span class="line">				context.beginPath();</span><br><span class="line">				context.arc(point.x,point.y,mr,0,Math.PI*2);</span><br><span class="line">				context.clip();</span><br><span class="line">				</span><br><span class="line">				context.drawImage(offCanvas,sx,sy,2*mr,2*mr,dx,dy,2*mr,2*mr);</span><br><span class="line">				context.restore();</span><br><span class="line">			&#125;</span><br><span class="line">		&lt;/script&gt;</span><br><span class="line">	&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
    
    
    <footer class="meta">
      
      
      
    </footer>
    
  </div>
  
</article></div>
  <footer id="footer" class="inner"><div class="social alignright">
  
  
  
  
  <a class="rss" href="/atom.xml" title="RSS">RSS</a>
</div>
<p>
  
  &copy; 2019 JDemon
  
</p>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id="phasebeam">
  <canvas></canvas>
  <canvas></canvas>
  <canvas></canvas>
</div>
<script src="/js/phasebeam.js"></script>
</body>
</html>